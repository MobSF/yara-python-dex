  
name: Upload Python Package
on: [push, pull_request]
#on:
#  release:
#    types: [created]

jobs: 
  publish:
     needs: build
     name: Publish to PyPI
     runs-on: ubuntu-latest

     steps:
     - name: Set up Python
       uses: actions/setup-python@v2
       with:
         python-version: '3.x'
     - name: Install twine
       run: |
         python -m pip install --upgrade pip
         pip install twine
     - name: Download Artifacts
       uses: actions/download-artifact@v2
       with:
         name: wheels
         path: ./wheels
     - name: Publish
       env:
         TWINE_USERNAME: ${{ secrets.TPYPI_USERNAME }}
         TWINE_PASSWORD: ${{ secrets.TPYPI_PASSWORD }}
       run: twine upload --repository testpypi ./wheels/*
